aic_results_final <- as.data.frame(results_modules_similarity) %>%
select(-df, -logLik) %>%
dplyr::rename(intercept='(Intercept)', grid_attributes=grid_attr, grid_distance=grid_dist, sm_similarity=sm_community) %>%
mutate(across(everything()), round(.,3))
# The best models: delta <= 10
results_modules_similarity <- subset(dredge_modules_similarity, delta <= 5 | df == 3 | df == max(df), recalc.weights = FALSE)
row.names(results_modules_similarity) <- c(1:(nrow(results_modules_similarity)))
# arranging the final table
aic_results_final <- as.data.frame(results_modules_similarity) %>%
select(-df, -logLik) %>%
dplyr::rename(intercept='(Intercept)', grid_attributes=grid_attr, grid_distance=grid_dist, sm_similarity=sm_community) %>%
mutate(across(everything()), round(.,3))
print(knitr::kable(aic_results_final))
View(imp)
View(imp)
imp[1]
imp[2]
imp[[1]]
View(imp)
colnames(imp) <- "importance"
# Plotting
g <- imp %>%
rownames_to_column("variable")
View(g)
# Plotting
g <- imp %>%
rownames_to_column("variable")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=importance())) +
geom_bar(color = variable) +
theme_vlassic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=importance())) +
geom_bar() +
theme_vlassic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=importance())) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
g <- imp %>%
rownames_to_column("variable")
View(g)
class(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=importance, y=variable)) +
geom_bar(color = variable) +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=variable, y=importance)) +
geom_bar(color = variable) +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes( y=importance)) +
geom_bar(color = variable) +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=variable, y=importance)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes( y=importance)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes( x=variable)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=variable, y=importance)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
ggplot(aes(x=as.factor(variable), y=importance)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, fill=variable)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
print(g)
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable))
View(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, y=importance, fill=variable)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12)) +
labs(x="Module Size", y="No. of Modules")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, fill=variable)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>% as.data.frame() %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, fill=variable)) +
geom_bar() +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
?geom_bar
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, y="importance", fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
arrange(importance) %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
g <- imp %>%
rownames_to_column("variable") %>%
arrange(importance)
View(g)
g <- imp %>%
rownames_to_column("variable") %>%
arrange(importance) %>%
mutate(variable = as.factor(variable))
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
arrange(importance) %>%
mutate(variable = as.factor(variable)) %>%
ggplot(aes(x=variable, y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
?arrange
g <- imp %>%
rownames_to_column("variable") %>%
arrange(importance) %>%
mutate(variable = as.factor(variable))
View(g)
g <- imp %>%
rownames_to_column("variable")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=variable, y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
scale_y_continuous(limits = c(0, 0.1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=variable, y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_classic() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
print(barplot(imp_values, names.arg=var_names, ylab = "Importance", ylim = c(0,1)))
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none") +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance, fill=variable)) +
geom_bar(stat="identity") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance, fill=variable)) +
geom_bar(stat="identity") +
scale_fill_hue(c = 40) +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#003049") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#ccc5b9") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#ccc5b9", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotate(geom = "text", x=variable, y=importance, label=importance) +
labs(x="", y="Variable's Importamce")
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
annotate(geom = "text", x=imp$variable, y=imp$importance, label=imp$importance) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
geom_text(aes(label=importance), vjust=0) +
# annotate(geom = "text", x=imp$variable, y=imp$importance, label=imp$importance) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
geom_text(aes(label=round(importance,2)), vjust=-0.1) +
# annotate(geom = "text", x=imp$variable, y=imp$importance, label=imp$importance) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
geom_text(aes(label=round(importance,2)), vjust=-1) +
# annotate(geom = "text", x=imp$variable, y=imp$importance, label=imp$importance) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
geom_text(aes(label=round(importance,2)), vjust=1) +
# annotate(geom = "text", x=imp$variable, y=imp$importance, label=imp$importance) +
labs(x="", y="Variable's Importamce")
print(g)
# Plotting
g <- imp %>%
rownames_to_column("variable") %>%
mutate(variable = factor(variable)) %>%
ggplot(aes(x=reorder(variable,-importance), y=importance)) +
geom_bar(stat="identity", fill = "#e5e5e5", color="#8b8c89") +
theme_bw() +
scale_y_continuous(limits = c(0, 1)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), strip.text.x = element_text(size=12), legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
geom_text(aes(label=round(importance,2)), vjust=-0.5) +
# annotate(geom = "text", x=imp$variable, y=imp$importance, label=imp$importance) +
labs(x="", y="Variable's Importamce")
print(g)
a=data_asv %>% group_by(village) %>% summarise(n=n_distinct(host_ID))
View(a)
b=data_asv %>% group_by(village) %>% summarise(n=n_distinct(asv_ID))
View(b)
rm(list=ls())
# reading the data
# small mammals (hosts)
data_mammals <- read_csv("data/data_raw/data_small_mammals/Terrestrial_Mammals.csv")
data_mammals %<>% mutate(host_ID = as.numeric(gsub(".*?([0-9]+).*", "\\1", animal_id))) %>%
select(host_ID, elevation.obs, sex, mass, age_repro) %>%
mutate(sex = as.factor(sex), age_repro = as.factor(age_repro))
data_asv <- read_csv("data/data_processed/microbiome/data_asv_rra0.01_th1000.csv")
data_asv_filtered <- data_asv %>%
filter(host_species == "Microgale brevicaudata" & village == "Mandena") %>%
select(host_ID, asv_ID, grid, season) %>%
left_join(data_mammals, by="host_ID")
data_asv <- read_csv("data/data_processed/microbiome/data_asv_rra0.01_th1000.csv")
data_asv_filtered <- data_asv %>%
filter(host_species == "Rattus rattus" & village == "Mandena" & grid != "village") %>%
select(host_ID, asv_ID, grid, season) %>%
left_join(data_mammals, by="host_ID")
data_asv_mat <- data_asv_filtered %>%
mutate(link = 1) %>%
spread(asv_ID, link, fill = 0)  %>%
gather("asv_ID","Link", starts_with("ASV"))
table(data_asv_mat$Link)
data_asv <- read_csv("data/data_processed/microbiome/data_asv_rra0.01_th1000.csv")
View(data_asv)
data_asv_filtered <- data_asv %>%
filter(host_species == "Rattus rattus" & village == "Andatsakala" & grid != "village") %>%
select(host_ID, asv_ID, grid, season) %>%
left_join(data_mammals, by="host_ID")
data_asv_mat <- data_asv_filtered %>%
mutate(link = 1) %>%
spread(asv_ID, link, fill = 0)  %>%
gather("asv_ID","Link", starts_with("ASV"))
table(data_asv_mat$Link)
View(data_asv)
data_asv_filtered <- data_asv %>%
filter(host_species == "Rattus rattus" & village == "Sarahandrano" & grid != "village") %>%
select(host_ID, asv_ID, grid, season) %>%
left_join(data_mammals, by="host_ID")
data_asv_mat <- data_asv_filtered %>%
mutate(link = 1) %>%
spread(asv_ID, link, fill = 0)  %>%
gather("asv_ID","Link", starts_with("ASV"))
table(data_asv_mat$Link)
unlink("code/modularity_analysis_main_cache", recursive = TRUE)
