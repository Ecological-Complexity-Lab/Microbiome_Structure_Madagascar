theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), panel.grid = element_blank(), legend.position="none",
strip.background = element_blank(), strip.text.x = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8) +
facet_wrap(~village) +
theme_bw() +
#geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), panel.grid = element_blank(), legend.position="none",
strip.background = element_blank(), strip.text.x = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8) +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), panel.grid = element_blank(), legend.position="none",
strip.background = "white", strip.text.x = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8) +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), panel.grid = element_blank(), legend.position="none") +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8) +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0, 0))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(1, 1))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.1))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", nmi), x = nmi, y = Inf),
hjust = 1, size = 4, color = "black") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", nmi), x = round(nmi,2), y = Inf),
hjust = 1.1, size = 3, color = "black") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", nmi), x = round(nmi,2), y = Inf),
vjust = 1.1, size = 3, color = "black") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = nmi, y = Inf),
vjust = 1.2, size = 3, color = "black") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = nmi, y = Inf),
vjust = 1.2, size = 3, color = "black") +
theme_bw() +
scale_y_continuous(limits = c(0, 180)) +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = nmi, y = Inf),
vjust = 1.2, size = 3, color = "black") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.3,hjust = 1.2, size = 3, color = "black") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1.2, size = 3, color = "black") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_text(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1.2, size = 4, color = "black", fill="grey", alpha=0.8) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_label(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1.2, size = 4, color = "black", fill="grey", alpha=0.8) +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_label(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1, size = 4, color = "black", fill="#edede9") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_label(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1.2, size = 4, color = "black", fill="white") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_label(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1.1, size = 4, color = "black", fill="white") +
theme_bw() +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
geom_label(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1.1, size = 4, color = "black", fill="white") +
theme_bw() +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
#plotting
betaNTI_g <- betaNTI_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_betaNTI = mean(betaNTI)) %>%
ggplot(aes(x=same_module, y=mean_betaNTI, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = betaNTI_summary, aes(label = sprintf("%.2f", betaNTI), y = betaNTI), position = position_dodge(width = 0.75), size = 4, color="white") +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw() +
scale_y_continuous(limits = c(-2, 4), breaks = seq(-2,4, by=2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y=paste("\u03B2","NTI", sep = ""))
cat('##', 'betaNTI','\n','\n')
# same module?
betaNTI_final <- betaNTI_three_villages %>%
mutate(same_module = ifelse(host_group1==host_group2, "Same","Different")) %>%
mutate(host_group1_org = host_group1) %>%
rowwise() %>%
mutate(host_group1 = sort(c(host_group1, host_group2))[1], host_group2 = sort(c(host_group1_org, host_group2))[2])
betaNTI_summary <- betaNTI_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_betaNTI = mean(betaNTI)) %>%
group_by(village, same_module) %>%
summarise(betaNTI = mean(mean_betaNTI))
print(knitr::kable(betaNTI_summary))
cat('\n')
#plotting
betaNTI_g <- betaNTI_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_betaNTI = mean(betaNTI)) %>%
ggplot(aes(x=same_module, y=mean_betaNTI, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = betaNTI_summary, aes(label = sprintf("%.2f", betaNTI), y = betaNTI), position = position_dodge(width = 0.75), size = 4, color="white") +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw() +
scale_y_continuous(limits = c(-2, 4), breaks = seq(-2,4, by=2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y=paste("\u03B2","NTI", sep = ""))
print(betaNTI_g)
cat('\n','\n')
cat('##', 'Raup-Crick','\n','\n')
# same module?
raupc_final <- raupc_three_villages %>%
mutate(same_module = ifelse(host_group1==host_group2, "Same","Different")) %>%
mutate(host_group1_org = host_group1) %>%
rowwise() %>%
mutate(host_group1 = sort(c(host_group1, host_group2))[1], host_group2 = sort(c(host_group1_org, host_group2))[2])
raupc_summary <- raupc_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_raupc = mean(raupc)) %>%
group_by(village, same_module) %>%
summarise(raupc = mean(mean_raupc))
print(knitr::kable(raupc_summary))
cat('\n')
#plotting
raupc_g <- raupc_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_raupc = mean(raupc)) %>%
ggplot(aes(x=same_module, y=mean_raupc, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_text(data = raupc_summary, aes(label = sprintf("%.2f", raupc), y = raupc), position = position_dodge(width = 0.75), size = 4, color="white") +
theme_bw() +
scale_y_continuous(limits = c(0, 1), breaks = seq(0,1, by=0.2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y="Raup-Crick")
print(raupc_g)
cat('\n','\n')
#plotting
betaNTI_g <- betaNTI_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_betaNTI = mean(betaNTI)) %>%
ggplot(aes(x=same_module, y=mean_betaNTI, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_text(data = betaNTI_summary, aes(label = sprintf("%.2f", betaNTI), y = betaNTI), position = position_dodge(width = 0.75), size = 4, color="white") +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw() +
scale_y_continuous(limits = c(-2, 4), breaks = seq(-2,4, by=2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y=paste("\u03B2","NTI", sep = ""))
print(betaNTI_g)
#plotting
raupc_g <- raupc_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_raupc = mean(raupc)) %>%
ggplot(aes(x=same_module, y=mean_raupc, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = raupc_summary, aes(label = sprintf("%.2f", raupc), y = raupc), position = position_dodge(width = 0.75), size = 4, color="white") +
theme_bw() +
scale_y_continuous(limits = c(0, 1), breaks = seq(0,1, by=0.2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y="Raup-Crick")
print(raupc_g)
#plotting
betaNTI_g <- betaNTI_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_betaNTI = mean(betaNTI)) %>%
ggplot(aes(x=same_module, y=mean_betaNTI, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = betaNTI_summary, aes(label = sprintf("%.2f", betaNTI), y = betaNTI), position = position_dodge(width = 0.75), size = 4, color="white", alpha=0.8) +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw() +
scale_y_continuous(limits = c(-2, 4), breaks = seq(-2,4, by=2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y=paste("\u03B2","NTI", sep = ""))
print(betaNTI_g)
#plotting
raupc_g <- raupc_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_raupc = mean(raupc)) %>%
ggplot(aes(x=same_module, y=mean_raupc, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = raupc_summary, aes(label = sprintf("%.2f", raupc), y = raupc), position = position_dodge(width = 0.75), size = 4, color="white",alpha=0.8) +
theme_bw() +
scale_y_continuous(limits = c(0, 1), breaks = seq(0,1, by=0.2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y="Raup-Crick")
print(raupc_g)
#plotting
raupc_g <- raupc_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_raupc = mean(raupc)) %>%
ggplot(aes(x=same_module, y=mean_raupc, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = raupc_summary, aes(label = sprintf("%.2f", raupc), y = raupc), position = position_dodge(width = 0.75), size = 4, color="white",alpha=0.8, legend=F) +
theme_bw() +
scale_y_continuous(limits = c(0, 1), breaks = seq(0,1, by=0.2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y="Raup-Crick")
print(raupc_g)
?geom_label
#plotting
raupc_g <- raupc_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_raupc = mean(raupc)) %>%
ggplot(aes(x=same_module, y=mean_raupc, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = raupc_summary, aes(label = sprintf("%.2f", raupc), y = raupc), position = position_dodge(width = 0.75), size = 4, color="white",alpha=0.8, show.legend=F) +
theme_bw() +
scale_y_continuous(limits = c(0, 1), breaks = seq(0,1, by=0.2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y="Raup-Crick")
print(raupc_g)
#plotting
betaNTI_g <- betaNTI_final %>%
group_by(village, same_module, host_group1, host_group2) %>%
summarise(mean_betaNTI = mean(betaNTI)) %>%
ggplot(aes(x=same_module, y=mean_betaNTI, fill=village)) +
geom_boxplot(outlier.shape = NA, alpha=0.8) +
geom_label(data = betaNTI_summary, aes(label = sprintf("%.2f", betaNTI), y = betaNTI), position = position_dodge(width = 0.75), size = 4,color="white",alpha=0.8, show.legend=F) +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_bw() +
scale_y_continuous(limits = c(-2, 4), breaks = seq(-2,4, by=2)) +
theme(axis.text = element_text(size = 14, color = 'black'), title = element_text(size = 20), panel.grid = element_blank()) +
scale_fill_manual(values=group.colors) +
labs(x="", y=paste("\u03B2","NTI", sep = ""))
print(betaNTI_g)
cat('## Observed NMI','\n')
# making a data frame out of the shuffled results
# loop for three villages
nmi_observed_df_tv <- NULL
for (j in 1:3) {
nmi_observed_df <- data_frame(nmi = nmi_observed_three_villages[[j*2]]) %>%
mutate(village = village_names[j])
nmi_observed_df_tv <- rbind(nmi_observed_df_tv, nmi_observed_df)
}
# making a data frame out of the observed results
nmi_observed_three_villages_df <- nmi_observed_three_villages[[1]] %>%
bind_rows(nmi_observed_three_villages[[3]]) %>%
bind_rows(nmi_observed_three_villages[[5]]) %>%
mutate(village = village_names)
g <- nmi_observed_df_tv %>%
ggplot(aes(nmi, fill=village)) +
geom_histogram(alpha=0.8, color="white") +
facet_wrap(~village, scales="free") +
scale_y_continuous(limits = c(0, 100)) +
geom_vline(data=nmi_observed_three_villages_df, aes(xintercept = nmi), linetype='dashed', color="black") +
geom_label(data = nmi_observed_three_villages_df, aes(label = paste("NMI =", round(nmi,2)), x = Inf, y = Inf),
vjust = 1.5,hjust = 1.1, size = 4, color = "black", fill="white") +
theme_bw() +
theme(axis.text = element_text(size = 10, color = 'black'), title = element_text(size = 14), strip.text = element_text(size=12), panel.grid = element_blank(), legend.position="none") +
scale_y_continuous(expand = expansion(mult = c(0.01, 0.01))) +
scale_fill_manual(values=group.colors) +
labs(x="Normalized Mutual Information (NMI)", y="Count")
print(g)
cat('\n','\n')
cat('## NMI for common microbes','\n')
nmi_observed_df <- nmi_diff_core_three_villages %>%
filter(type=="core", degree==1) %>%
arrange(village)
p1 <- nmi_diff_core_three_villages %>%
filter(type == "core") %>%
mutate(nmi = ifelse(is.na(nmi),0,nmi)) %>%
ggplot(aes(x=degree, y=nmi, color = village)) +
#geom_hline(yintercept=nmi_observed_df$nmi, linetype = "dashed", color=group.colors) +
geom_line() +
geom_point(aes(shape = as.factor(sig), size = n_module)) +
scale_size_continuous( breaks = c(1,10,40,80)) +
scale_shape_manual(values = c(1, 16), guide="none") +
scale_y_continuous(limits = c(0, 0.35)) +
scale_x_continuous(limits = c(0, 20)) +
theme_bw() +
theme(axis.text = element_text(size = 12, color = 'black'), title = element_text(size = 15), panel.grid = element_blank(), panel.border = element_rect(color = "black"), legend.position = c(.95, .95), legend.justification = c("right", "top"),  legend.title = element_text(size = 12)) +
scale_color_manual(values=group.colors) +
guides(size = guide_legend(order = 2), color = guide_legend(order = 1)) +
labs(x="Minimum ASVs Degree", y="Normalized Mutual Information (NMI)", size = "No. of Modules", color = "Village")
print(p1)
#legend.position = c(.95, .95), legend.justification = c("right", "top"),
cat('\n','\n')
